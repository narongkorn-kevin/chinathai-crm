<div class="flex flex-col flex-auto min-w-0">
    <div class="flex-auto  sm:p-10 bg-card m-4 p-4 rounded-md">
        <div class="flex flex-row justify-between pb-2 items-center">
            <div class="flex flex-col">
                <div class="flex space-x-2">
                    <a [routerLink]="[ '/order-products']"
                        class="md:text-sm font-medium tracking-tight leading-7 sm:leading-10 truncate">
                        ฝากสั่งสินค้า
                    </a>
                    <p class="md:text-sm font-medium tracking-tight leading-7 sm:leading-10 truncate">></p>
                    <p class="md:text-sm font-medium tracking-tight leading-7 sm:leading-10 truncate text-[#DF0B12]">
                        รายการฝากสั่งซื้อสินค้า
                    </p>


                </div>

                <div class="flex flex-row gap-4">
                    <p class="md:text-2xl text-[#DF0B12] font-bold tracking-tight leading-7 sm:leading-10 truncate">
                        หมายเลขฝากสั่ง: {{data?.code}}
                    </p>

                    @if (data?.status) {
                    <asha-status-chip [status]="data?.status"></asha-status-chip>
                    }
                </div>
            </div>
            <div class="flex space-x-2">
                <button mat-flat-button class="!text-white" [color]="'accent'" (click)="clickUpdateStatus()">
                    <mat-icon class="icon-size-5" [svgIcon]="'heroicons_solid:pencil'"></mat-icon>
                    <span class="ml-2"> อัพเดตสถานะ</span>
                </button>

                <button [cdkMenuTriggerFor]="menu" mat-flat-button class="!text-white" [color]="'primary'">
                    <mat-icon class="icon-size-5" [svgIcon]="'work_outline'"></mat-icon>
                    <div class="flex items-center gap-2">
                        <span class="ml-2"> การจัดการข้อมูล </span>
                        <mat-icon class="icon-size-5" [svgIcon]="'heroicons_solid:chevron-up'"></mat-icon>
                    </div>
                </button>

                <ng-template #menu>
                    <div class="manage-menu bg-primary" cdkMenu>
                        <button class="manage-menu-item text-white" cdkMenuItem>
                            <mat-icon class="icon-size-5 text-white"
                                [svgIcon]="'heroicons_solid:document-duplicate'"></mat-icon>
                            <span class="ml-2">Copy to Clipboard</span>
                        </button>
                        <button class="manage-menu-item text-white" cdkMenuItem>
                            <mat-icon class="icon-size-5 text-white"
                                [svgIcon]="'heroicons_solid:table-cells'"></mat-icon>
                            <span class="ml-2">CSV</span>
                        </button>
                        <button class="manage-menu-item text-white" cdkMenuItem>
                            <mat-icon class="icon-size-5 text-white"
                                [svgIcon]="'heroicons_solid:table-cells'"></mat-icon>
                            <span class="ml-2">Excel</span>
                        </button>
                        <button class="manage-menu-item text-white" cdkMenuItem>
                            <mat-icon class="icon-size-5 text-white" [svgIcon]="'heroicons_solid:printer'"></mat-icon>
                            <span class="ml-2">Print</span>
                        </button>
                    </div>
                </ng-template>
            </div>
        </div>

        <div class="border-b-2 w-full my-4"></div>

        <!-- ข้อมูลพื้นฐาน -->
        <div class="flex flex-col w-full gap-4 mb-3">
            <div class="w-full grid grid-cols-4 font-semibold">
                <div class="">ข้อมูลพื้นฐาน</div>
                <div class="">ชื่อลูกค้า</div>
                <div class="">เบอร์โทร</div>
                <div class="">รูปแบบการขนส่ง</div>
            </div>
            <div class="w-full grid grid-cols-4">
                <div class=""></div>
                <div class="">{{data?.member?.code}} {{data?.member?.fname}} {{data?.member?.lname}}</div>
                <div class="">{{data?.member?.phone}}</div>
                <div class="">{{data?.shipping_type}}</div>
            </div>
            <div class="w-full grid grid-cols-4 font-semibold">
                <div class=""></div>
                <div class="">ที่อยู่</div>
                <div class=""></div>
                <div class=""></div>
            </div>
            <div class="w-full grid grid-cols-4">
                <div class=""></div>
                <div class="col-span-3">
                    {{ data?.member?.address }}
                    {{ data?.member?.sub_district }}
                    {{ data?.member?.district }}
                    {{ data?.member?.province }}
                    {{ data?.member?.postal_code }}
                </div>
            </div>
        </div>

        <div class="flex flex-row w-full bg-[#9C1F230D] text-[#9C1F23] px-4 py-3 mb-3">
            <div class="mr-2">
                <mat-icon class="text-[#9C1F23]" svgIcon="heroicons_outline:megaphone"></mat-icon>
            </div>
            <div class="flex flex-col">
                <div class="font-semibold">หมายเหตุจากผู้ซื้อ</div>
                <div>{{data?.note ?? '-'}}</div>
            </div>
        </div>


        <div class="border rounded p-4">
            <div class="flex justify-between">
                <div class="">
                    <p class="font-bold text-3xl pb-4">รายการสั่งซื้อสินค้า</p>
                </div>
                <div class="flex gap-2">
                    <button mat-flat-button class="!text-white" [color]="'accent'" [disabled]="!someSelect()" (click)="clickUpdateOrderListStatus('waiting_for_review')">
                        <mat-icon class="icon-size-5" [svgIcon]="'heroicons_solid:magnifying-glass'"></mat-icon>
                        <span class="ml-2"> รอตรวจสอบ</span>
                    </button>
                    <button mat-flat-button class="!text-white" [color]="'primary'" [disabled]="!someSelect()" (click)="clickUpdateOrderListStatus('reviewed')">
                        <mat-icon class="icon-size-5" [svgIcon]="'heroicons_solid:document-check'"></mat-icon>
                        <span class="ml-2"> ตรวจสอบแล้ว</span>
                    </button>
                    <button mat-flat-button class="!text-white" [color]="'warn'" [disabled]="!someSelect()" (click)="clickUpdateOrderListStatus('reject')">
                        <mat-icon class="icon-size-5" [svgIcon]="'heroicons_solid:trash'"></mat-icon>
                        <span class="ml-2"> ยกเลิกรายการ</span>
                    </button>
                </div>
            </div>

            <div class="border-b-2 w-full my-4"></div>

            <table class="w-full table-auto border">
                <thead>
                    <tr>
                        <th>
                            <mat-checkbox [checked]="selectAll" [indeterminate]="someSelect()"
                                (change)="SelectAll($event.checked)"></mat-checkbox>
                        </th>
                        <th>#</th>
                        <th>ดำเนินการ</th>
                        <th>รูปภาพ</th>
                        <th>ชื่อผลิตภัณฑ์</th>
                        <th>ราคา</th>
                        <th>จำนวนชิ้น</th>
                        <th>ราคารวม</th>
                        <th>เลขติดตาม</th>
                        <th>ลิงก์</th>
                        <th>สถานะ</th>
                    </tr>
                </thead>
                <tbody class="text-center">
                    @for (orderList of data?.order_lists; track orderList.id;let i = $index) {
                    <tr>
                        <td>
                            <mat-checkbox [(ngModel)]="orderList.IsChecked"
                                (ngModelChange)="updateAllselect()"></mat-checkbox>
                        </td>
                        <td>{{i + 1}}</td>
                        <td>
                            <button mat-flat-button class="!text-white" [color]="'accent'" (click)="clickUpdateTack(orderList)">
                                <mat-icon class="icon-size-5" [svgIcon]="'heroicons_solid:plus'"></mat-icon>
                                <span class="ml-2"> การขนส่ง</span>
                            </button>
                        </td>
                        <td>
                            <img class="w-15" [src]="orderList?.product_image">
                        </td>
                        <td>{{orderList?.product_name}}</td>
                        <td>{{orderList?.product_price | number:'1.2-2'}}</td>
                        <td>{{orderList?.product_qty}}</td>
                        <td>{{orderList?.product_total | number:'1.2-2'}}</td>
                        <td>{{orderList?.track_ecommerce_no ?? '-'}}</td>
                        <td>
                            <a *ngIf="orderList?.product_url; else noLink"
                               [href]="orderList?.product_url"
                               target="_blank"
                               rel="noopener noreferrer" class="font-bold text-blue-600 hover:underline">
                              เปิดลิงก์
                            </a>
                            <ng-template #noLink>-</ng-template>
                          </td>

                        <td>
                          <span [ngSwitch]="orderList?.status">
                            <span *ngSwitchCase="'waiting_for_review'"
                              class="px-4 py-1.5 rounded-full text-sm inline-flex items-center justify-center font-medium bg-yellow-50 text-yellow-600 border border-yellow-200">
                              รอตรวจสอบ
                            </span>
                            <span *ngSwitchCase="'reviewed'"
                              class="px-4 py-1.5 rounded-full text-sm inline-flex items-center justify-center font-medium
                                                                                                               bg-blue-50 text-blue-600 border border-blue-200">
                              ตรวจสอบแล้ว
                            </span>
                            <span *ngSwitchCase="'reject'"
                              class="px-4 py-1.5 rounded-full text-sm inline-flex items-center justify-center font-medium
                                                                                                          bg-red-50 text-red-600 border border-red-200">
                              ยกเลิกรายการ
                            </span>
                            <span *ngSwitchDefault> - </span>
                          </span>
                        </td>

                    </tr>
                    }
                </tbody>
            </table>

            <div class="border-b-2 w-full my-4"></div>

            <div class="flex flex-row p-6 gap-5">
                <div class="flex items-start space-x-2 w-1/3">
                    <h3 class="text-3xl font-semibold">สรุปข้อมูล</h3>
                    <button class="bg-yellow-500 text-white p-2 rounded-md" (click)="clickEditFee()">
                        <mat-icon class="text-white" svgIcon="heroicons_outline:pencil-square"></mat-icon>
                    </button>
                </div>

                <div class=" text-gray-700 space-y-2 w-1/3">
                    <div class="flex flex-col">
                        <div class="flex w-80 flex-row justify-between">
                            <p>ค่าธรรมเนียมบริการฝากสั่ง (บาท) :</p>
                            <span class="font-medium">{{data?.order_fee ?? '-'}}</span>
                        </div>
                        <div class="flex w-80 flex-row justify-between">
                            <p>อัตราแลกเปลี่ยน ณ วันที่ออกบิล (บาท) :</p>
                            <span class="font-medium">{{data?.order_fee ?? '-'}}</span>
                        </div>
                        <div class="flex w-80 flex-row justify-between">
                            <p>ค่าขนส่งฝั่งจีน (บาท) :</p>
                            <span class="font-medium">{{data?.order_fee ?? '-'}}</span>
                        </div>
                    </div>
                </div>


                <div
                    class="flex flex-row items-center justify-around w-1/3 bg-gray-800 text-white text-center py-4 rounded-lg">
                    <p class="text-lg font-semibold">ราคารวมทั้งสิ้น</p>
                    <p class="text-2xl font-bold">{{data?.total_price | number:'1.2-2'}} บาท</p>
                </div>
            </div>
        </div>
    </div>

    <!-- <div class="รายละเอียดใบรับเข้าคลัง/PO">
        <div class="w-full border-2 rounded mb-4">
            <div class="p-4">
                <p class="font-semibold">รายละเอียดทั่วไป</p>
                <div class="grid grid-cols-12 gap-8 mb-4">
                    <div class="col-span-6">
                        <p class="md:text-sm font-medium tracking-tight leading-7 sm:leading-10 truncate">Shipment
                            Code</p>
                        <div class="h-[32px] w-full bg-gray-100 rounded"></div>
                    </div>
                    <div class="col-span-6">
                        <p class="md:text-sm font-medium tracking-tight leading-7 sm:leading-10 truncate">
                            วันที่เข้าโกดัง</p>
                        <div class="h-[32px] w-full bg-gray-100 rounded"></div>
                    </div>
                </div>
            </div>
        </div>
        <div class="w-full border-2 rounded mb-4">
            <div class="p-4">
                <div class="flex flex-row justify-between pb-2 items-center">
                    <p class="font-semibold">รายการสินค้า</p>
                    <div class="flex space-x-2">
                        <button
                            class="w-auto h-[32px] px-4 bg-[#DF0B12] rounded flex items-center justify-center space-x-1">
                            <mat-icon svgIcon="heroicons_outline:document-duplicate"
                                class="text-white icon-size-4"></mat-icon>
                            <p class="text-white text-xs font-medium pt-[3px]">Copy to Clipboard</p>
                        </button>
                        <button
                            class="w-auto h-[32px] px-4 bg-[#DF0B12] rounded flex items-center justify-center space-x-1">
                            <mat-icon svgIcon="heroicons_outline:calculator" class="text-white icon-size-4"></mat-icon>
                            <p class="text-white text-xs font-medium pt-[3px]">CSV</p>
                        </button>
                        <button
                            class="w-auto h-[32px] px-4 bg-[#DF0B12] rounded flex items-center justify-center space-x-1">
                            <mat-icon svgIcon="heroicons_outline:table-cells" class="text-white icon-size-4"></mat-icon>
                            <p class="text-white text-xs font-medium pt-[3px]">Excel</p>
                        </button>
                        <button
                            class="w-auto h-[32px] px-4 bg-[#DF0B12] rounded flex items-center justify-center space-x-1">
                            <mat-icon svgIcon="heroicons_outline:printer" class="text-white icon-size-4"></mat-icon>
                            <p class="text-white text-xs font-medium pt-[3px]">Print</p>
                        </button>
                    </div>

                </div>
                <div>
                    <p class="font-semibold">ตัวกรอง</p>
                    <div class="grid grid-cols-3 gap-4 mb-8">
                        <div class="col-span-1">
                            <p class="md:text-sm font-medium tracking-tight leading-7 sm:leading-10 truncate">
                                ชื่อลูกค้า</p>
                            <input class="border-2 rounded w-full h-[32px] px-2 text-sm placeholder:text-sm"
                                placeholder="">
                        </div>
                        <div class="col-span-1">
                            <p class="md:text-sm font-medium tracking-tight leading-7 sm:leading-10 truncate">เลขที่
                                PO</p>
                            <input class="border-2 rounded w-full h-[32px] px-2 text-sm placeholder:text-sm"
                                placeholder="">
                        </div>
                        <div class="col-span-1">
                            <p class="md:text-sm font-medium tracking-tight leading-7 sm:leading-10 truncate">
                                การขนส่ง</p>
                            <input class="border-2 rounded w-full h-[32px] px-2 text-sm placeholder:text-sm"
                                placeholder="">
                        </div>
                    </div>
                    <div class="flex justify-center">
                        <table *ngIf="dtOptions && dtOptions.data && dtOptions.data.length > 0" datatable
                            [dtOptions]="dtOptions" [dtTrigger]="dtTrigger"
                            class="row-border hover whitespace-nowrap overflow-auto">
                        </table>
                        <p *ngIf="!dtOptions?.data?.length" class="font-semibold my-16">ไม่พบรายการสินค้า</p>
                    </div>
                </div>
            </div>
        </div>
    </div> -->
</div>


<ng-template #pic let-data="adtData">
    <div class="flex flex-row justify-center">
        <img [src]="data?.product_image" alt="Image" class="rounded-md w-20 text-center" />
    </div>
</ng-template>
